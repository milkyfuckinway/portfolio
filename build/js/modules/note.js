let deviceType="";const isTouchDevice=()=>{try{return document.createEvent("TouchEvent"),deviceType="touch",!0}catch(e){return deviceType="mouse",!1}};isTouchDevice();const events={mouse:{down:"mousedown",move:"mousemove",up:"mouseup",click:"click"},touch:{down:"touchstart",move:"touchmove",up:"touchend",click:"click"}};let initialX=0,initialY=0,initialzIndex=0,moveElement=!1;const desktopFooter=document.querySelector(".desktop__footer"),referenceTemplate=document.querySelector(".reference");let lastFile;const fileList=document.querySelectorAll(".file");fileList.forEach((e=>{const t=e.querySelector(".window"),c=e.querySelector(".window__button--collapse"),i=e.querySelector(".window__button--expand"),n=e.querySelector(".window__button--close"),o=e.querySelector(".window__draggable-area"),l=e.querySelector(".file__label"),s=referenceTemplate.cloneNode(!0),d=e.querySelector(".window__header"),r=e.querySelector(".window__path"),a=e.querySelector(".file__name"),v=()=>{const e=initialzIndex+1;t.style.zIndex=`${e}`,initialzIndex=e,lastFile=s;document.querySelectorAll(".window__header").forEach((e=>{e.classList.remove("window__header--active")})),d.classList.add("window__header--active")},u=()=>{document.querySelectorAll(".reference").forEach((e=>{e.classList.remove("reference--active")})),s.classList.add("reference--active")},p=()=>{u(),t.classList.contains("window--collapsed")?(t.classList.remove("window--collapsed"),v()):s!==lastFile?v():t.classList.add("window--collapsed")},m=()=>{const c=s.querySelector(".reference__text");t.classList.remove("window--collapsed"),l.classList.add("file__label--active"),t.style.left="50%",t.style.top="50%",t.style.transform="translate(-50%, -50%)",c.textContent=a.textContent,s.addEventListener("click",p),s.classList.add("reference--active");const i=e.querySelector(".file__icon").cloneNode(!0);s.insertBefore(i,c);const n=e.querySelector(".file__icon").cloneNode(!0);o.insertBefore(n,r),desktopFooter.appendChild(s),l.removeEventListener(events[deviceType].click,m),y(),u(),v()},w=e=>{if(moveElement){const c=isTouchDevice()?e.touches[0].clientX:e.clientX,i=isTouchDevice()?e.touches[0].clientY:e.clientY;t.style.left=t.offsetLeft-(initialX-c)+"px",t.style.top=t.offsetTop-(initialY-i)+"px",initialX=c,initialY=i}};function y(){moveElement=!1,document.removeEventListener(events[deviceType].move,w),document.removeEventListener(events[deviceType].up,y)}l.addEventListener(events[deviceType].click,m),c.addEventListener(events[deviceType].click,p),n.addEventListener(events[deviceType].click,(()=>{t.classList.add("window--collapsed"),l.classList.remove("file__label--active"),s.remove(),l.addEventListener(events[deviceType].click,m)})),i.addEventListener(events[deviceType].click,(()=>{t.classList.remove("window--collapsed"),t.classList.toggle("window--fullscreen")})),t.addEventListener(events[deviceType].down,(()=>{u(),v()})),o.addEventListener(events[deviceType].down,(e=>{e.cancelable&&e.preventDefault(),t.classList.contains("window--fullscreen")||(moveElement=!0,initialX=isTouchDevice()?e.touches[0].clientX:e.clientX,initialY=isTouchDevice()?e.touches[0].clientY:e.clientY,document.addEventListener(events[deviceType].move,w),document.addEventListener(events[deviceType].up,y))}))})),desktopFooter.addEventListener("wheel",(e=>{e.preventDefault(),desktopFooter.scrollLeft+=e.deltaY}));